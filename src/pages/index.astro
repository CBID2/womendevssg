---
import { getCollection } from "astro:content";
import Layout from "@layouts/Layout.astro";
import Header from "@components/Header.astro";
import Footer from "@components/Footer.astro";
import LinkButton from "@components/LinkButton.astro";
import Card from "@components/Card";
import Socials from "@components/Socials.astro";
import getSortedPosts from "@utils/getSortedPosts";
import { SITE, SOCIALS } from "@config";

const posts = await getCollection("blog");

const sortedPosts = getSortedPosts(posts);
const recentPosts = sortedPosts.filter(({ data }) => !data.featured);

const socialCount = SOCIALS.filter(social => social.active).length;
---

<Layout>
  <Header />
  <main id="main-content">
    <section id="hero">
      <h1>
        Dedicated to inspiring women to excel in technology careers.
      </h1>
      <img src={`/assets/banner.jpg`}/>
      {
        // only display if at least one social link is enabled
        socialCount > 0 && (
          <div class="social-wrapper">
            <Socials />
          </div>
        )
      }
    </section>
    <section id="hero">
    <div class="flex justify-between items-center pb-6 pt-8 flex-wrap">
      <div class="w-full text-center sm:w-1/2 sm:text-left sm:p-4">
        <h2 class="text-3xl font-bold">Become a member</h2>
        <p>Enhance your skills, join a supportive network, and elevate your career.</p>
        <a href="https://t.me/+hh3Fts4oDG41NzQ1" target="_blank" rel="noopener noreferrer">
        <button class="mt-4 px-6 py-2 text-white font-semibold rounded">
          Join our community
        </button>
      </a>
      </div>
      <div class="w-full sm:w-1/2 sm:p-4">
        <img id="community-img" src="/assets/community.svg" alt="Become a member image"/>
      </div>
    </div>
  </section> 
  <section id="hero">
    <div class="flex justify-between items-center pb-6 pt-8 flex-wrap">
      <div class="w-full sm:w-1/2 sm:p-4">
        <img id="community-img" src="/assets/lead.svg" alt="Join our community">
      </div>
      <div class="w-full text-center sm:w-1/2 sm:text-left sm:p-4 sm:pl-10">
        <h2 class="text-3xl font-bold">Become a volunteer</h2>
        <p>Hone your leadership, project management and communication skills with us.</p>
        <a href="https://forms.gle/9Lg9Dx8ETdZRvqjx8" target="_blank" rel="noopener noreferrer">
        <button class="mt-4 px-6 py-2 text-white font-semibold rounded">
          Sign up as a volunteer
        </button>
      </a>
      </div>
    </div>
  </section> 
    <section id="events">
      <h2 class="mb-8 text-center">Upcoming Events</h2>
      <div class="calendar-container">
        <iframe
          src="https://calendar.google.com/calendar/embed?height=600&wkst=1&bgcolor=%230535D1&showTz=0&showPrint=0&showTitle=0&showNav=0&showTabs=0&src=MzIwYjg0ODM3MWJjMDUyYjg5OWRhNTYyZTJmYTU4YjIxZjY3MDJlM2NkYWU3YWY0OGI4YjhkNWQ3NWMzYzA4YkBncm91cC5jYWxlbmRhci5nb29nbGUuY29t&color=%234285F4"
          width="800"
          height="600"
        ></iframe>
      </div>
    </section>
    {
      recentPosts.length > 0 && (
        <section id="recent-posts">
          <h2>Community Blog</h2>
          <p>You can contribute your knowledge here!</p>
          <ul>
            {recentPosts.map(
              ({ data, slug }, index) =>
                index < SITE.postPerIndex && (
                  <Card
                    href={`/blog/${slug}/`}
                    frontmatter={data}
                    secHeading={false}
                  />
                )
            )}
          </ul>
        </section>
      )
    }

    <div class="all-posts-btn-wrapper">
      <LinkButton href="/blog/">
        All Posts
        <svg xmlns="http://www.w3.org/2000/svg"
          ><path
            d="m11.293 17.293 1.414 1.414L19.414 12l-6.707-6.707-1.414 1.414L15.586 11H6v2h9.586z"
          ></path>
        </svg>
      </LinkButton>
    </div>
  </main>

  <Footer />
</Layout>

<style>
  /* ===== Hero Section ===== */
  #hero {
    @apply pb-6 pt-8 w-full max-w-6xl;
  }
  #hero h1 {
    @apply my-4 inline-block text-3xl font-bold sm:my-8 sm:text-5xl;
  }
  #hero .rss-link {
    @apply mb-6;
  }
  #hero .rss-icon {
    @apply mb-2 h-6 w-6 scale-110 fill-skin-accent sm:mb-3 sm:scale-125;
  }
  #hero p {
    @apply my-2;
  }
  .social-wrapper {
    @apply mt-4 flex flex-col sm:flex-row sm:items-center;
  }

  /* ===== Featured & Recent Posts Sections ===== */
  .calendar-container {
    border-radius: 12px; 
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); 
    overflow: hidden; 
  }

.calendar-container iframe {
  width: 100%; 
  height: 600px; 
  border: none; 
}

  #events,
  #recent-posts {
    @apply pb-6 pt-12 w-full max-w-6xl;
  }
  #events h2,
  #recent-posts h2 {
    @apply text-3xl font-semibold tracking-wide;
  }
  .all-posts-btn-wrapper {
    @apply my-8 text-center;
  }

  html[data-theme="light"] button{
    background-color: rgb(5,53,209);
  }

  html[data-theme="dark"] button {
    background-color: rgb(16, 155, 255);
  } 

  html[data-theme="dark"] #community-img {
    filter: brightness(1.3) contrast(0.9);
  } 
</style>
